let recursive = \self ->
    (\a -> self (\b -> (a a) b))
    (\a -> self (\b -> (a a) b))

let :> = \a -> \b -> :! (:< a b)
let :<= = \a -> \b -> or (:< a b) (:= a b)
let :>= = \a -> \b -> or (:> a b) (:= a b)

let true = 1
let false = 0
let _ = nil

let pair = \first -> \second -> \consumer -> consumer first second

let head = \pair -> pair (\head -> \tail -> head)
let tail = \pair -> pair (\head -> \tail -> tail)

let map = recursive (\self ->
    \sequence -> \transform ->
        if := (tail sequence) nil
        then pair (transform (head sequence)) nil
        else pair
            (transform (head sequence))
            (self (tail sequence) transform)
)

let fold = recursive (\self ->
    \sequence -> \accumulate -> \value ->
        if := (tail sequence) nil
        then accumulate value (head sequence)
        else self (tail sequence) (accumulate) (accumulate value (head sequence))
)
